---
title: "Climates during the spread of the Neolithic"
subtitle: "Central and Western Mediterranean"
author:
  - name: Thomas Huet
    affiliation: 
      - id: cnrs
        name: <span style="font-size:16pt">CNRS</span>
  - name: <u>Niccolò Mazzucco</u>
    affiliation: 
      - id: up
        name: <span style="font-size:16pt">Università di Pisa</span>
title-slide-attributes:
    data-background-image: "https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2024-simep/img/bck-img-2.png"
    data-background-size: "110%"
    data-background-opacity: "0.3"
    data-notes: This presentation examines the spread of farming across the Central and Western North Mediterranean (from Italy to Portugal) between 6000 and 5000 BC using quantitative methods. Specifically, it employs the R neonet framework to analyze over 2,500 curated radiocarbon dates from the latest phases of the Mesolithic and the earliest phases of the Neolithic (Huet et al., 2022 and 2024), calculating the isochrones of the farming pioneer front and incorporating palaeoclimate reconstructions (via the R pastclim package). Although the granularity of our modeling does not allow for precise mapping of subregional ecozones (e.g., wetlands), the diffusion model clearly demonstrates that ecological barriers, such as latitudes and mountain ranges, significantly slowed the neolithization process. Furthermore, our framework offers substantial potential for reproducibility and enhances comparisons with previous models (e.g., Binder et al., 2019). The early farmer colonization of Southern Italy, around 6000 BC, aligns with the PPN (Pre-Pottery Neolithic) core model of neolithization, which posits early farming settlements in temperate climates with dry, hot summers ('Csa' in the Köppen Climate Classification). Once early farmers reached the Tyrrhenian Sea, between 5800 and 5600 BC, the process of 'leapfrog' colonization began, marked by Neolithic settlements established along the Mediterranean shore via seafaring, without prior continental continuity. From 5600 to 5000 BC, we observe the resilience of the latest foragers (Late Mesolithic), who became 'cornered' in the northwest of the Iberian Peninsula, particularly in regions such as Galicia, Asturias, and Cantabria.
format:
  revealjs: 
    css: https://zoometh.github.io/thomashuet/css/quarto.css
    controls: true
    auto-stretch: false
    code-fold: false
    code-summary: "<small>Code</small>"
    slide-number: true
    chalkboard:
      theme: "whiteboard"
      color: ['rgba(255, 0, 0, 0.3)'] # red
    scrollable: true
    preview-links: auto
    reference-location: document
    footnotes-hover: true
    # self-contained: true
    # embed-resources: true
    # logo: https://raw.githubusercontent.com/zoometh/neonet/master/doc/img/neonet.png
    footer: "Huet & Mazzucco  - <img src='https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-ene2/img/_logo.png' style='height: 25px;vertical-align: middle;'> -  May 22-25, 2025, University of Zadar, Croatia"
    margin: 0
    width: 1200
---


# Materials and Methods {background-image="https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2024-simep/img/bck-img-2-50perc.png"}

::: notes
Data: radiocarbon dates and palaeoclimatic data.
:::

## Radiocarbon data

::: {.panel-tabset}


### Sources

::: columns
::: {.column width="60%"}
![](https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2024-simep/img/dbs_counts.png){width="550" style="horizontal-align: middle;"}
\
\

:::

::: {.column width="40%"}
<span style="color:#0000CF; font-size: 20px;">Early Mesolithic (EM)</span><br>
<span style="color:#1D1DFF; font-size: 20px;">Middle Mesolithic (MM)</span><br>
<span style="color:#3737FF; font-size: 25px;"><b>Late Mesolithic (LM)</b></span><br>
<span style="color:#FF1B1B; font-size: 25px;"><b><u>Early Neolithic (EN)</u></b></span><br>
<span style="color:#FF8D1B; font-size: 20px;">Middle Neolithic (MN)</span><br>
<span style="color:#FFC04D; font-size: 20px;">Late Neolithic (LN)</span><br>
:::

:::


### Align<sup>t</sup>

<small><span style="color: red;">EN</span> alignments</small>

::: {.column width="70%"}


```{r, message=FALSE}
library(DT)
library(dplyr)
ref_table_per = "https://raw.githubusercontent.com/zoometh/neonet/refs/heads/main/inst/extdata/ref_table_per-readonly.tsv"
df.to.rm <- read.csv2(ref_table_per, sep = "\t", header = TRUE)
df.to.rm.en <- df.to.rm[df.to.rm$class == "en", ]
df.to.rm.en %>% 
  DT::datatable(
    width = "100%",
    rownames = FALSE,
    options=list(
      lengthMenu = list(c(5, 10, 50, -1), 
                        c('5', '10', '50', 'All')),
      paging = T,
      initComplete = htmlwidgets::JS(
        "function(settings, json) {",
        paste0("$(this.api().table().container()).css({'font-size': '", "12pt", "'});"),
        "}")
    ) 
  )
#, options = list(width = "700px", pageLength = 10))
```
<small>[ref_table_per.xlsx](https://github.com/zoometh/neonet/blob/main/inst/extdata/ref_table_per.xlsx)</small>

:::

::: {.column width="30%"}

<!-- Neonet classes -->

<table style="font-size: 25px;">
<tr>
<td><span style="color:#0000CF">EM - Early Mesolithic</span></td>
</tr>
<tr>
<td><span style="color:#1D1DFF">MM - Middle Mesolithic</span></td>
</tr>
<tr>
<td><span style="color:#3737FF"><b>LM - Late Mesolithic</b></span></td>
</tr>
<tr>
<td><span style="color:#FF1B1B"><b><u>EN - Early Neolithic</u></b></span></td>
</tr>
<tr>
<td><span style="color:#FF8D1B">MN - Middle Neolithic</span></td>
</tr>
<tr>
<td><span style="color:#FFC04D">LN - Late Neolithic</span></td>
</tr>
</table>

:::

::: notes
- 8 different databases and datasets. Among which 2 are the Neonet datasets. We collect using the c14bazAAR and curated with NeoNet functions.
- mapping table with period and culture coming from different datasest to be mapped to the Neonet main classes (10 classes, among which 4 are undefined and period transition).
- Using 
:::

### Outliers


```{r, message=FALSE}
library(DT)
library(dplyr)
c14.to.remove = "https://raw.githubusercontent.com/zoometh/neonet/main/inst/extdata/c14_aberrant_dates.tsv"
df.to.rm <- read.csv2(c14.to.remove, sep = "\t", header = TRUE)
df.to.rm %>% 
  DT::datatable(
    width = "100%",
    rownames = FALSE,
    options=list(
      lengthMenu = list(c(5, 10, 50, -1), 
                        c('5', '10', '50', 'All')),
      paging = T,
      initComplete = htmlwidgets::JS(
        "function(settings, json) {",
        paste0("$(this.api().table().container()).css({'font-size': '", "12pt", "'});"),
        "}")
    ) 
  )
#, options = list(width = "700px", pageLength = 10))
```
<small>[c14_aberrant_dates.tsv](https://github.com/zoometh/neonet/blob/main/inst/extdata/c14_aberrant_dates.tsv)</small>


::: notes
- With R functions coming from the C14bazaar R package and curated with the NeoNet R series of functions, we are gathering some 10,000 radiocarbon dates coming from 8 different datasets and databases. 
- We map these dates to the Neonet periods (here on the left **class**).
- Then we remove duplicated dates and discard outliers (currently in process).
- Some 4,000 dates are now available for the study.
:::

### Locat<sup>o</sup>


::: columns

::: {.column width="50%"}
<center>

```{r}
library(dplyr)
# df <- st_read(paste0(dirIn, "neonet-data-2023-10-22-select-aera.geojson"), quiet = T)
sitenames <- "https://raw.githubusercontent.com/zoometh/neonet/master/inst/extdata/c14_corrected_sitenames.geojson"
df <- sf::st_read(sitenames, quiet = T)
df.altern <- subset(df, !is.na(AlternativeNames))
df.altern$popup_content <- apply(sf::st_drop_geometry(df.altern), 1, function(row) {
  paste0("<b>SiteName:</b> ", row["SiteName"], "<br>",
         "<b>AlternativeNames:</b> ", row["AlternativeNames"], "<br>")
})
leaflet::leaflet(df.altern, width = "650px", height = "400px") %>%
  leaflet::addTiles() %>%  # Add base tiles
  leaflet::addCircleMarkers(
    data = df.altern,
    popup = ~popup_content,  # Use the dynamically generated popup content
    radius = 3, 
    color = "blue"
  )
```

</center>

<small>[c14_corrected_sitenames.geojson](https://github.com/zoometh/neonet/blob/main/inst/extdata/c14_corrected_sitenames.geojson)</small>
:::

::: {.column width="50%"}
<img src="https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-ene2/img/method_github_issues_sitenames.png" width="400">

:::

:::


::: notes

:::

### Base

<center>

<img src="https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-bspf/img/_map_data_EN.png" style="width: 750px;horizontal-align: middle;"/>

</center>

### Medians


::: columns

::: {.column width="25%"}
Most ancient <span style="color: red;">EN</span> date weighted medians (w-medians) by site.
:::

::: {.column width="75%"}
<img src="https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-ene2/img/_date_pendimoun_EN.png" width="600">
:::

:::


::: notes
- For a given site, we select either the most recent LM date (ex: Monte Frignone) or simetrically the most ancient EN date (ex: Le Baratin)
- Extract on the radiocarbon date weighted median from the Summed probability density (SPD)
:::

:::

## Köppen climate classes

::: columns

::: {.column width="33%"}
<!-- Mid-Holocene (c. 6,000 BP)<br> -->

**Data**
<br>
<small>- Mean annual temperature (ºC)</small><br>
<small>- Annual precipitation (mm year <sup>-1</sup>)</small><br>
<small>- Biome (pollen-based)</small><br>
<br>
<br>
<small>Beyer et *al.* 2020[^1]</small>
:::

::: {.column width="33%"}
**IT**
<br>
<img src="https://raw.githubusercontent.com/EvolEcolGroup/pastclim/master/man/figures/logo.png" style="height: 80px;vertical-align: middle;"/><small> [pastclim::koeppen_geiger()](https://github.com/EvolEcolGroup/pastclim)<br></small>

<img src="https://raw.githubusercontent.com/zoometh/neonet/master/doc/img/logo_nn_pkg.png" style="height: 80px;vertical-align: middle;"/><small> [neonet::neo_kss_create()](https://github.com/zoometh/neonet/blob/main/R/neo_kcc_create.R)</small>


:::

::: {.column width="33%"}
**OUTPUT**
<br>
<img src="https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2024-simep/img/kcc_maps_by_ky.jpg" width="500">
:::

:::




# Spread of Neolithic in the Central Western Mediterranean {background-image="https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2024-simep/img/bck-img-2-50perc.png"}

::: notes
Radiocarbon dates are still being revised, and many of them need to be verified. First modeling
:::


## 6100-6000 BC

```{r, message=FALSE}
df <- "data-isochr-EN-6100-BC-MedWestEst-koppen_8k"
img <- "isochr-EN-6100-BC-MedWestEst-koppen_8k"
root <- "https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-ene2/img/"
```

::: {.panel-tabset}

### Dates

::: columns

::: {.column width="65%"}

```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```

:::


::: {.column width="35%"}

```{r, message=FALSE}
data <- paste0(root, df, ".tsv")
source(paste0(here::here(), "/R/neo_dbs_info_dates_datatable.R"))
neo_dbs_info_dates_datatable(df.c14 = data, verbose = FALSE, fields = c("idf", "site", "labcode", "median", "code", "color"), order.by = "median")
```
:::

:::

### Observations


::: columns

::: {.column width="50%"}
```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```
:::


::: {.column width="50%"}

<p><small>

* Lorem Ipsum <span style="color:#FFFF00;">Csa</span> (*Temperate, dry summer, hot summer*) and <span style="color:#FFDC64;">BSk</span> (*Temperate, dry summer, warm summer*) climates.
* Early settlement: <span style="color:#FFFF00;">Lorem Ipsum</span> (idf <b>Lorem Ipsum</b>).

</small></p>

:::

:::

:::


## 5800 BC

```{r, message=FALSE}
df <- "data-isochr-EN-5800-BC-MedWest-koppen_8k"
img <- "isochr-EN-5800-BC-MedWest-koppen_8k"
root <- "https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-bspf/img/"
```

::: {.panel-tabset}

### Dates

::: columns

::: {.column width="60%"}

```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```

:::


::: {.column width="40%"}

```{r, message=FALSE}
data <- paste0(root, df, ".tsv")
source(paste0(here::here(), "/R/neo_dbs_info_dates_datatable.R"))
neo_dbs_info_dates_datatable(df.c14 = data, verbose = FALSE, fields = c("idf", "site", "labcode", "median", "code", "color"), order.by = "median")
```
:::

:::

### Observations


::: columns

::: {.column width="50%"}
```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```
:::


::: {.column width="50%"}

<p><small>

* Lorem Ipsum <span style="color:#FFFF00;">Csa</span> (*Temperate, dry summer, hot summer*) and <span style="color:#FFDC64;">BSk</span> (*Temperate, dry summer, warm summer*) climates.
* Early settlement: <span style="color:#FFFF00;">Lorem Ipsum</span> (idf <b>Lorem Ipsum</b>).

</small></p>

:::

:::

:::


## 5600 BC

```{r, message=FALSE}
df <- "data-isochr-EN-5600-BC-MedWest-koppen_8k"
img <- "isochr-EN-5600-BC-MedWest-koppen_8k"
root <- "https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-bspf/img/"
```

::: {.panel-tabset}

### Dates

::: columns

::: {.column width="60%"}

```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```

:::


::: {.column width="40%"}

```{r, message=FALSE}
data <- paste0(root, df, ".tsv")
source(paste0(here::here(), "/R/neo_dbs_info_dates_datatable.R"))
neo_dbs_info_dates_datatable(df.c14 = data, verbose = FALSE, fields = c("idf", "site", "labcode", "median", "code", "color"), order.by = "median")
```
:::

:::

### Observations


::: columns

::: {.column width="50%"}
```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```
:::


::: {.column width="50%"}

<p><small>

* Lorem Ipsum <span style="color:#FFFF00;">Csa</span> (*Temperate, dry summer, hot summer*) and <span style="color:#FFDC64;">BSk</span> (*Temperate, dry summer, warm summer*) climates.
* Early settlement: <span style="color:#FFFF00;">Lorem Ipsum</span> (idf <b>Lorem Ipsum</b>).

</small></p>

:::

:::

:::


## 5400 BC

```{r, message=FALSE}
df <- "data-isochr-EN-5400-BC-MedWest-koppen_7k"
img <- "isochr-EN-5400-BC-MedWest-koppen_7k"
root <- "https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-bspf/img/"
```

::: {.panel-tabset}

### Dates

::: columns

::: {.column width="60%"}

```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```

:::


::: {.column width="40%"}

```{r, message=FALSE}
data <- paste0(root, df, ".tsv")
source(paste0(here::here(), "/R/neo_dbs_info_dates_datatable.R"))
neo_dbs_info_dates_datatable(df.c14 = data, verbose = FALSE, fields = c("idf", "site", "labcode", "median", "code", "color"), order.by = "median")
```
:::

:::

### Observations


::: columns

::: {.column width="50%"}
```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```
:::


::: {.column width="50%"}

<p><small>

* Lorem Ipsum <span style="color:#FFFF00;">Csa</span> (*Temperate, dry summer, hot summer*) and <span style="color:#FFDC64;">BSk</span> (*Temperate, dry summer, warm summer*) climates.
* Early settlement: <span style="color:#FFFF00;">Lorem Ipsum</span> (idf <b>Lorem Ipsum</b>).

</small></p>

:::

:::

:::


## 5200 BC

```{r, message=FALSE}
df <- "data-isochr-EN-5200-BC-MedWest-koppen_7k"
img <- "isochr-EN-5200-BC-MedWest-koppen_7k"
root <- "https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-bspf/img/"
```

::: {.panel-tabset}

### Dates

::: columns

::: {.column width="60%"}

```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```

:::


::: {.column width="40%"}

```{r, message=FALSE}
data <- paste0(root, df, ".tsv")
source(paste0(here::here(), "/R/neo_dbs_info_dates_datatable.R"))
neo_dbs_info_dates_datatable(df.c14 = data, verbose = FALSE, fields = c("idf", "site", "labcode", "median", "code", "color"), order.by = "median")
```
:::

:::

### Observations


::: columns

::: {.column width="50%"}
```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```
:::


::: {.column width="50%"}

<p><small>

* Lorem Ipsum <span style="color:#FFFF00;">Csa</span> (*Temperate, dry summer, hot summer*) and <span style="color:#FFDC64;">BSk</span> (*Temperate, dry summer, warm summer*) climates.
* Early settlement: <span style="color:#FFFF00;">Lorem Ipsum</span> (idf <b>Lorem Ipsum</b>).

</small></p>

:::

:::

:::


## 5000 BC

```{r, message=FALSE}
df <- "data-isochr-EN-5000-BC-MedWest-koppen_7k"
img <- "isochr-EN-5000-BC-MedWest-koppen_7k"
root <- "https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-bspf/img/"
```

::: {.panel-tabset}

### Dates

::: columns

::: {.column width="60%"}

```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```

:::


::: {.column width="40%"}

```{r, message=FALSE}
data <- paste0(root, df, ".tsv")
source(paste0(here::here(), "/R/neo_dbs_info_dates_datatable.R"))
neo_dbs_info_dates_datatable(df.c14 = data, verbose = FALSE, fields = c("idf", "site", "labcode", "median", "code", "color"), order.by = "median")
```
:::

:::

### Observations


::: columns

::: {.column width="50%"}
```{r echo=FALSE, out.width='100%'}
map <- paste0(root, img, ".png")
knitr::include_graphics(map)
```
:::


::: {.column width="50%"}

<p><small>

* Lorem Ipsum <span style="color:#FFFF00;">Csa</span> (*Temperate, dry summer, hot summer*) and <span style="color:#FFDC64;">BSk</span> (*Temperate, dry summer, warm summer*) climates.
* Early settlement: <span style="color:#FFFF00;">Lorem Ipsum</span> (idf <b>Lorem Ipsum</b>).

</small></p>

:::

:::

:::

# Synthesis {background-image="https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2024-simep/img/bck-img-2-50perc.png"}

## Climate changes and <span style="color: red;">EN</span> occupations (6000-5000 BC)


::: columns

::: {.column width="30%"}

```{r echo=FALSE, out.width='30%'}
root <- "https://raw.githubusercontent.com/zoometh/neonet/master/doc/talks/2025-ene2/img/"
map <- paste0(root, "_sankey_changes.png")
knitr::include_graphics(map)
```

:::

::: {.column width="70%"}

```{r echo=FALSE, out.width='75%'}
map <- paste0(root, "_stacked_time_bin.png")
knitr::include_graphics(map)
```
:::

:::


# Thank you {background-image="https://raw.githubusercontent.com/zoometh/neonet/master/doc/img/method_github_issues_dates.png"}

<https://github.com/zoometh/neonet>

::: notes
- Contribution: mapping table (archaeologists), interpolation methods (mathematician), aggregating data from other sources (aDNA, etc.), etc.
:::

